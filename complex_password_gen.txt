# Import System.Web assembly
Add-Type -AssemblyName System.Web
# Generate random password
[System.Web.Security.Membership]::GeneratePassword(11,2)
Function GenerateStrongPassword ([Parameter(Mandatory=$true)][int]$PasswordLenght)
{
Add-Type -AssemblyName System.Web
$PassComplexCheck = $false
do {
$newPassword=[System.Web.Security.Membership]::GeneratePassword($PasswordLenght,1)
If ( ($newPassword -cmatch "[A-Z\p{Lu}\s]") `
-and ($newPassword -cmatch "[a-z\p{Ll}\s]") `
-and ($newPassword -match "[\d]") `
-and ($newPassword -match "[^\w]")
)
{
$PassComplexCheck=$True
}
} While ($PassComplexCheck -eq $false)
return $newPassword
}

Import-Csv "C:\Directoryhere" | ForEach-Object {
#Import from .csv file
$samAccountName = $_."samAccountName"
#Un-comment the below line if your CSV file includes password for all users
#$newPassword = ConvertTo-SecureString -AsPlainText $_."Password"Â  -Force

Set-ADAccountPassword -Identity $samAccountName -NewPassword $newPassword -Reset
# Calls on the new password listed above.
Set-AdUser -Identity $samAccountName -ChangePasswordAtLogon $true
# Forces user to change password at next login.
Write-Host " AD Password has been reset for: "$samAccountName
# Writes to PS window stating the changes took affect.
