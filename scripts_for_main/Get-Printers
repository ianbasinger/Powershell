## This script is mainly used to be ran on a local machine to get a quick list of printers and useful information for them

function Get-Printers
{
  $printers = Get-WmiObject -Query "Select * From Win32_Printer" | Sort-Object Name
  # Get local printer objects on the machine
  foreach ($printer in $printers) {
  # Loop through list of printers (as most machines have more than 1)
      $name = $printer.Name
      if ($name -eq 'Fax') {
          continue
      }
      $driverName = $printer.DriverName
      $portName = $printer.PortName
      $location = $printer.Location
      $printProcessor = $printer.PrintProcessor
      $serverName = $printer.ServerName
      $shared = $printer.Shared
      $shareName = $printer.ShareName
      $published = $printer.Published
      $default = $printer.Default
      $sharedName = $printer.SharedName
      $duplex = $printer.Duplex
      $printPermissions = $printer.PrinterPermissions
      $managePermissions = $printer.ManagePrinterPermissions
      $controlPermissions = $printer.ManageDocumentsPermissions
      # Get various printer diagnostics and info, assign to variables to use later

      $port = Get-WmiObject -Query "Select * From Win32_PrinterConfiguration WHERE Name = '$name'"
      # Port is a useful piece of info to know, for example to determine if something is using WSD or TCP/IP
      $portType = $port.PrinterStatus
      $portDescription = $port.PrinterStatusDescriptions

      $jobCount = $printer.JobCount
      $jobStatus = $printer.JobStatus
      # Get printer jobs

      $printQueue = Get-PrintJob -PrinterName $name
      # Get the printer queue

      $printerStatus = switch ($printer.PrinterStatus) {
          1 { 'Other' }
          2 { 'Unknown' }
          3 { 'Idle' }
          4 { 'Printing' }
          5 { 'Warming Up' }
          6 { 'Stopped Printing' }
          7 { 'Offline' }
          8 { 'Paused' }
          9 { 'Error' }
          10 { 'Busy' }
          11 { 'Not Available' }
          12 { 'Waiting' }
          default { 'Unknown' }
          # Switch statement to let us know printers current status. For example if a printer is in Offline or Error state, we use this to display that.
      }

      # Prints out all of the information we need for each printer, seperated by a green line. Color coded to make it easier to read as well
      Write-Host "Printer Name: $name" -ForegroundColor Green
      Write-Host "Location/IP: $location" -ForegroundColor Green
      Write-Host "Driver Name: $driverName" -ForegroundColor Green
      Write-Host "Port Name: $portName" -ForegroundColor Green
      Write-Host "Port Type: $portType" -ForegroundColor Green
      Write-Host "Port Description: $portDescription" -ForegroundColor Green
      Write-Host "Printer Status: $printerStatus" -ForegroundColor Red
      Write-Host "Job Count: $jobCount" -ForegroundColor Cyan
      Write-Host "Job Status: $jobStatus" -ForegroundColor Cyan
      Write-Host "Print Queue: $($printQueue | Format-Table | Out-String)"  -ForegroundColor Cyan
      Write-Host "Print Processor: $printProcessor" -ForegroundColor Yellow
      Write-Host "Server Name: $serverName" -ForegroundColor Yellow
      Write-Host "Shared: $shared" -ForegroundColor Yellow
      Write-Host "Share Name: $shareName" -ForegroundColor Yellow
      Write-Host "Published: $published" -ForegroundColor Yellow
      Write-Host "Default: $default" -ForegroundColor Yellow
      Write-Host "Shared Name: $sharedName" -ForegroundColor Yellow
      Write-Host "Duplex: $duplex" -ForegroundColor Yellow
      Write-Host "Printer Permissions: $printPermissions" -ForegroundColor Magenta
      Write-Host "Manage Printer Permissions: $managePermissions" -ForegroundColor Magenta
      Write-Host "Manage Documents Permissions: $controlPermissions" -ForegroundColor Magenta
      Write-Host "-------------------------------------------------------------------------------------------------------------------------------------------" -ForegroundColor Green
  }
}
